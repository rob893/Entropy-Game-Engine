!function(t){var e={};function s(i){if(e[i])return e[i].exports;var n=e[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=t,s.c=e,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)s.d(i,n,function(e){return t[e]}.bind(null,n));return i},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=4)}([function(t,e,s){t.exports=s.p+"249faac8674a31fa922af6089863bffa.png"},function(t,e,s){t.exports=s.p+"0121541694936934c979ae0cf0c66a34.png"},function(t,e,s){t.exports=s.p+"27f0d2999953e5a8c430d7ae4c132a11.png"},function(t,e,s){t.exports=s.p+"007ba97e337cb75dc893e5a570455315.png"},function(t,e,s){"use strict";s.r(e);class i{constructor(t,e){this.x=0,this.y=0,this.x=t,this.y=e}get sqrMagnitude(){return this.x*this.x+this.y*this.y}get magnitude(){return Math.sqrt(this.sqrMagnitude)}get normalized(){return this.divide(new i(this.magnitude,this.magnitude))}add(t){return this.x+=t.x,this.y+=t.y,this}subtract(t){return this.x-=t.x,this.y-=t.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}divide(t){return this.x/=t.x,this.y/=t.y,this}equals(t){let e=this.x===t.x,s=this.y===t.y;return e&&s}multiplyScalar(t){return this.x*=t,this.y*=t,this}divideScalar(t){return this.x/=t,this.y/=t,this}zero(){return this.x=0,this.y=0,this}static get up(){return new i(0,1)}static get down(){return new i(0,-1)}static get left(){return new i(-1,0)}static get right(){return new i(1,0)}static get zero(){return new i(0,0)}static get one(){return new i(1,1)}static add(t,e){return new i(t.x+e.x,t.y+e.y)}static distance(t,e){let s=t.x-e.x,i=t.y-e.y;return Math.sqrt(s*s+i*i)}static angleInRadians(t,e){let s=i.dot(t,e)/(t.magnitude*e.magnitude);return Math.acos(s)}static angleInDegrees(t,e){return 180*this.angleInRadians(t,e)/Math.PI}static dot(t,e){return t.x*e.x+t.y*e.y}}class n{static onSegment(t,e,s){return e.x<=Math.max(t.x,s.x)&&e.x>=Math.min(t.x,s.x)&&e.y<=Math.max(t.y,s.y)&&e.y>=Math.min(t.y,s.y)}static orientation(t,e,s){let i=(e.y-t.y)*(s.x-e.x)-(e.x-t.x)*(s.y-e.y);return 0===i?0:i>0?1:2}static doIntersect(t,e,s,i){let n=this.orientation(t,e,s),a=this.orientation(t,e,i),o=this.orientation(s,i,t),r=this.orientation(s,i,e);return n!==a&&o!==r||(!(0!==n||!this.onSegment(t,s,e))||(!(0!==a||!this.onSegment(t,i,e))||(!(0!==o||!this.onSegment(s,t,i))||!(0!==r||!this.onSegment(s,e,i)))))}static doIntersectRectangle(t,e,s,i,n,a){return!!(this.doIntersect(t,e,s,i)||this.doIntersect(t,e,s,n)||this.doIntersect(t,e,n,a)||this.doIntersect(t,e,i,a))}}class a{constructor(){this.rigidbodies=[],this.colliders=[],this.gravity=1}static get Instance(){return this.instance||(this.instance=new a)}addRigidbody(t){this.rigidbodies.push(t)}addCollider(t){this.colliders.push(t)}static raycast(t,e,s){let n=null,o=a.raycastAll(t,e,s),r=-10;for(let e of o){let s=i.distance(t,e.transform.position);s>r&&(n=e,r=s)}return n}static raycastAll(t,e,s){let o=[],r=i.add(t,e.multiplyScalar(s));for(let e of a.Instance.colliders)n.doIntersectRectangle(t,r,e.topLeft,e.topRight,e.bottomLeft,e.bottomRight)&&o.push(e);return o}static sphereCast(){}static overlapSphere(){return[]}}class o{static get DeltaTime(){return this.deltaTime}static get TotalTime(){return(Date.now()-this.startTime)/1e3}static start(){this.prevTime=Date.now(),this.startTime=this.prevTime}static updateTime(){this.deltaTime=(Date.now()-this.prevTime)/1e3,this.prevTime=Date.now()}}o.deltaTime=0,o.startTime=0,o.prevTime=0;class r{constructor(){this.gameObjects=[],this.gameObjectMap=new Map,this.gameObjectNumMap=new Map,this.gameInitialized=!1,this.paused=!1,this.gameInitialized=!1,this.physicsEngine=a.Instance}static get Instance(){return this.instance||(this.instance=new r)}initializeGame(t,e,s){this.background=s,this.setGameCanvas(t),this.setGameObjects(e),this.gameInitialized=!0}startGame(){if(!this.gameInitialized)throw new Error("The game is not initialized yet!");o.start(),this.paused=!1;for(let t=0;t<this.gameObjects.length;t++)this.gameObjects[t].start();requestAnimationFrame(()=>this.gameLoop())}instantiate(t){if(this.gameObjectMap.has(t.id)){let e=t.id;t.id+=" Clone("+this.gameObjectNumMap.get(e)+")",this.gameObjectNumMap.set(e,this.gameObjectNumMap.get(e)+1)}else this.gameObjectNumMap.set(t.id,1);return this.gameObjectMap.set(t.id,t),this.gameObjects.push(t),t.start(),t}getGameObjectById(t){if(!this.gameObjectMap.has(t))throw new Error("No GameObject with id of "+t+" exists!");return this.gameObjectMap.get(t)}getGameCanvas(){return this.gameCanvas}getGameCanvasContext(){return this.canvasContext}printGameData(){console.log(this),console.log("Time since game start "+o.TotalTime+"s");for(let t=0;t<this.gameObjects.length;t++)console.log(this.gameObjects[t])}togglePause(){this.paused=!this.paused}setGameCanvas(t){this.gameCanvas=t,this.canvasContext=this.gameCanvas.getContext("2d")}setGameObjects(t){this.gameObjects=t;for(let e of t){if(this.gameObjectMap.has(e.id)){let t=e.id;e.id+=" Clone("+this.gameObjectNumMap.get(t)+")",this.gameObjectNumMap.set(t,this.gameObjectNumMap.get(t)+1)}else this.gameObjectNumMap.set(e.id,1);this.gameObjectMap.set(e.id,e)}}update(){if(!this.paused){o.updateTime(),this.renderBackground();for(let t=0;t<this.gameObjects.length;t++)this.gameObjects[t].update()}}renderBackground(){this.background.render()}gameLoop(){this.update(),requestAnimationFrame(()=>this.gameLoop())}}class h{constructor(t){this.gameObject=t}start(){}update(){}}class m{constructor(){this.handlers=[]}add(t){this.handlers.push(t)}remove(t){this.handlers=this.handlers.filter(e=>e!==t)}trigger(t){this.handlers.slice(0).forEach(e=>e(t))}expose(){return this}}class c extends h{constructor(t,e,s,n,a){super(t),this.width=0,this.height=0,this.onMove=new m,this.width=n,this.height=a,this.position=new i(e,s),this.rotation=0}get onMoved(){return this.onMove.expose()}get center(){return new i(this.position.x+this.width/2,this.position.y+this.height/2)}get bottomCenter(){return new i(this.position.x+this.width/2,this.position.y+this.height)}translate(t){this.position.x+=t.x,this.position.y+=-1*t.y,this.onMove.trigger()}setPosition(t,e){this.position.x=t,this.position.y=e,this.onMove.trigger()}}class d{constructor(t,e=0,s=0,i=0,n=0){this.components=[],this.componentMap=new Map,this.id=t,this.transform=new c(this,e,s,i,n)}start(){this.gameCanvas=r.Instance.getGameCanvas(),this.canvasContext=this.gameCanvas.getContext("2d");for(let t=0;t<this.components.length;t++)this.components[t].start()}update(){for(let t=0;t<this.components.length;t++)this.components[t].update()}getTransform(){return this.transform}getGameCanvas(){return this.gameCanvas}getComponent(t){let e=t.name;if(!this.componentMap.has(e))throw new Error(e+" not found on the GameObject with id of "+this.id+"!");return this.componentMap.get(e)}addComponent(t){if(this.componentMap.has(t.constructor.name))throw new Error("There is already a component of type "+t.constructor.name+" on this object!");return this.components.push(t),this.componentMap.set(t.constructor.name,t),t.start(),t}setComponents(t){this.components=t;for(let e of t){if(this.componentMap.has(e.constructor.name))throw new Error("There is already a component of type "+e.constructor.name+" on this object!");this.componentMap.set(e.constructor.name,e)}}}class l extends h{constructor(t){super(t),this.onCollide=new m,this.transform=t.getTransform();let e=this.transform;e.onMoved.add(()=>this.onTransformMoved()),this.topLeft=new i(e.position.x,e.position.y),this.topRight=new i(e.position.x+e.width,e.position.y),this.bottomLeft=new i(e.position.x,e.position.y+e.height),this.bottomRight=new i(e.position.x+e.width,e.position.y+e.height),a.Instance.addCollider(this)}detectCollision(t){return!(t.topLeft.x>this.topRight.x||t.topRight.x<this.topLeft.x||t.topLeft.y>this.bottomLeft.y||t.bottomLeft.y<this.topLeft.y)&&(this.onCollide.trigger(t),!0)}get onCollided(){return this.onCollide.expose()}onTransformMoved(){this.topLeft.x=this.transform.position.x,this.topLeft.y=this.transform.position.y,this.topRight.x=this.transform.position.x+this.transform.width,this.topRight.y=this.transform.position.y,this.bottomLeft.x=this.transform.position.x,this.bottomLeft.y=this.transform.position.y+this.transform.height,this.bottomRight.x=this.transform.position.x+this.transform.width,this.bottomRight.y=this.transform.position.y+this.transform.height}}class p extends h{constructor(t){super(t),this.xVelocity=0,this.yVelocity=0,this.speed=5,this.transform=t.getTransform()}start(){this.gameCanvas=this.gameObject.getGameCanvas()}update(){this.move(),this.handleOutOfBounds()}}class u extends p{constructor(t){super(t),this.ready=!0,this.reset()}start(){super.start(),this.collider=this.gameObject.getComponent(l),this.playerCollider=r.Instance.getGameObjectById("player").getComponent(l),this.computerCollider=r.Instance.getGameObjectById("computer").getComponent(l),this.collider.onCollided.add(t=>this.handleCollision(t))}update(){super.update(),this.detectCollisions()}handleCollision(t){this.ready&&(this.ready=!1,this.xVelocity*=-1,this.speed+=.125,setTimeout(()=>{this.ready=!0},250))}handleOutOfBounds(){this.transform.position.y<=0?this.yVelocity*=-1:this.transform.position.y>=this.gameCanvas.height-this.transform.height&&(this.yVelocity=Math.abs(this.yVelocity)),this.transform.position.x+this.transform.width<=0?this.reset():this.transform.position.x>=this.gameCanvas.width&&this.reset()}move(){this.transform.translate(new i(this.xVelocity,this.yVelocity).multiplyScalar(this.speed))}reset(){this.transform.setPosition(345,195),this.xVelocity=Math.random()<.5?-1:1,this.yVelocity=Math.random()<.5?-1:1,this.speed=3}detectCollisions(){this.collider.detectCollision(this.playerCollider),this.collider.detectCollision(this.computerCollider)}}class g extends h{constructor(t,e){super(t),this.transform=t.getTransform(),this.color=e}start(){this.gameCanvas=this.gameObject.getGameCanvas(),this.canvasContext=this.gameCanvas.getContext("2d")}update(){this.render()}setColor(t){this.color=t}render(){this.canvasContext.fillStyle=this.color,this.canvasContext.fillRect(this.transform.position.x,this.transform.position.y,this.transform.width,this.transform.height)}}class y extends d{constructor(t){super(t,345,195,10,10);let e=[];e.push(new l(this)),e.push(new u(this)),e.push(new g(this,"white")),this.setComponents(e)}}class f extends h{constructor(t){super(t),document.getElementById("print-button").addEventListener("click",()=>this.printGameData()),document.getElementById("pause-button").addEventListener("click",()=>this.togglePause()),document.getElementById("add-ball").addEventListener("click",()=>this.testInstantiate())}start(){this.player=r.Instance.getGameObjectById("player")}static get Instance(){if(null===this.instance||void 0===this.instance)throw new Error("GameManager has not been created yet. Use the createInstance method first.");return this.instance}static createInstance(t){if(null===this.instance||void 0===this.instance)return this.instance=new f(t),this.instance;throw new Error("More than one GameManager cannot be created!")}togglePause(){r.Instance.togglePause()}printGameData(){r.Instance.printGameData()}testInstantiate(){r.Instance.instantiate(new y("ball2"))}}class x extends h{constructor(){super(...arguments),this.numFrames=0,this.timer=0,this.FPS=0}start(){this.canvasContext=r.Instance.getGameCanvasContext(),this.canvasContext.font="20px Arial"}update(){this.timer+=o.DeltaTime,this.numFrames++,this.timer>=.5&&(this.FPS=this.numFrames/this.timer,this.timer=0,this.numFrames=0),this.canvasContext.fillText("FPS: "+this.FPS.toFixed(2),0,20)}}var w;!function(t){t[t.UP=38]="UP",t[t.DOWN=40]="DOWN",t[t.LEFT=37]="LEFT",t[t.RIGHT=39]="RIGHT",t[t.W=87]="W",t[t.A=65]="A",t[t.S=83]="S",t[t.D=68]="D",t[t.SPACE=32]="SPACE"}(w||(w={}));class v extends h{constructor(t,e=70){super(t),this.isKinomatic=!1,this.transform=t.getTransform(),this.mass=e,this.velocity=new i(0,0),this.acceleration=new i(0,0),this.force=i.zero,a.Instance.addRigidbody(this)}update(){this.isKinomatic||(this.addGravity(665),this.velocity.add(this.force.divideScalar(this.mass)),this.transform.translate(this.velocity))}addForce(t){this.force.add(t)}addGravity(t){this.addForce(i.down.multiplyScalar(t).multiplyScalar(o.DeltaTime))}resetForce(){this.force.zero(),this.velocity.zero()}}var C=s(0),b=s.n(C),I=s(1),O=s.n(I);class j extends h{constructor(t,e){super(t),this.animation=e}start(){this.canvasContext=this.gameObject.getGameCanvas().getContext("2d"),this.transform=this.gameObject.getTransform()}update(){this.drawSprite()}setAnimation(t){this.animation=t}drawSprite(){this.animation.animationReady&&(this.canvasContext.drawImage(this.animation.currentFrame,this.transform.position.x,this.transform.position.y,this.transform.width,this.transform.height),this.animation.updateAnimation())}}class M{constructor(t,e,s,i=0,n=null){this.loop=!0,this.animationReady=!1,this.frames=[],this.frameIndex=0,this.delay=0,this.timer=0,this.delay=i;let a=new Image;a.src=t,a.onload=()=>{let t=a.width/e,i=a.height/s;if(null!==n)for(let o of n){if(o<1||o>s)throw new Error("Invalid specificRow argument. It must be greater than 0 and less than or equal to numRows.");for(let s=0;s<e;s++){this.animationReady=!1;let e=document.createElement("canvas");e.width=t,e.height=i,e.getContext("2d").drawImage(a,s*t,(o-1)*i,t,i,0,0,e.width,e.height);let n=new Image;n.src=e.toDataURL(),n.onload=()=>{this.frames.push(n),this.animationReady=!0}}}else for(let n=0;n<s;n++)for(let s=0;s<e;s++){this.animationReady=!1;let e=document.createElement("canvas");e.width=t,e.height=i,e.getContext("2d").drawImage(a,s*t,n*i,t,i,0,0,e.width,e.height);let o=new Image;o.src=e.toDataURL(),o.onload=()=>{this.frames.push(o),this.animationReady=!0}}}}get currentFrame(){return this.frames[this.frameIndex]}updateAnimation(){(this.loop||this.frameIndex!==this.frames.length-1)&&(this.timer+=o.DeltaTime,this.timer<this.delay||(this.timer=0,this.frameIndex=(this.frameIndex+1)%this.frames.length))}}class T extends p{constructor(t){super(t),this.movingRight=!1,this.movingLeft=!1,this.jumping=!1,document.addEventListener("keydown",()=>this.onKeyDown(event)),document.addEventListener("keyup",()=>this.onKeyUp(event)),document.addEventListener("click",()=>this.onClick(event)),this.moveRightAnimation=new M(b.a,4,1,.1),this.moveLeftAnimation=new M(O.a,4,1,.1)}start(){super.start(),this.rigidBody=this.gameObject.getComponent(v),this.animator=this.gameObject.getComponent(j)}get isMoving(){return 0!==this.xVelocity||0!==this.yVelocity}handleOutOfBounds(){this.transform.position.y<=0?this.transform.position.y=1:this.transform.position.y+this.transform.height>=this.gameCanvas.height-55&&(this.rigidBody.isKinomatic=!0,this.jumping=!1,this.transform.position.y=this.gameCanvas.height-this.transform.height-56),this.transform.position.x<=0?this.transform.position.x=1:this.transform.position.x+this.transform.width>=this.gameCanvas.width&&(this.transform.position.x=this.gameCanvas.width-this.transform.width-1)}move(){this.movingRight?this.xVelocity=1:this.movingLeft?this.xVelocity=-1:this.xVelocity=0,this.isMoving&&this.transform.translate(new i(this.xVelocity,this.yVelocity).multiplyScalar(this.speed))}jump(){this.jumping||(this.jumping=!0,this.rigidBody.isKinomatic=!1,this.rigidBody.resetForce(),this.rigidBody.addForce(i.up.multiplyScalar(400)))}onClick(t){a.raycast(new i(this.transform.position.x,this.transform.position.y-1),i.right,5e3)}onKeyDown(t){t.keyCode==w.RIGHT||t.keyCode==w.D?(this.movingRight=!0,this.movingLeft=!1,this.animator.setAnimation(this.moveRightAnimation)):t.keyCode!=w.LEFT&&t.keyCode!=w.A||(this.movingRight=!1,this.movingLeft=!0,this.animator.setAnimation(this.moveLeftAnimation)),t.keyCode==w.SPACE&&this.jump()}onKeyUp(t){t.keyCode==w.RIGHT||t.keyCode==w.D?this.movingRight=!1:t.keyCode!=w.LEFT&&t.keyCode!=w.A||(this.movingLeft=!1)}}class R extends p{constructor(t){super(t),this.timer=0,this.yVelocity=1}start(){super.start(),this.ballTransform=r.Instance.getGameObjectById("ball").getTransform(),this.quarterFieldX=this.gameCanvas.width/4,this.midFieldY=this.gameCanvas.height/2}handleOutOfBounds(){this.transform.position.y<=0?this.yVelocity=-1:this.transform.position.y>=this.gameCanvas.height-this.transform.height&&(this.yVelocity=1)}move(){this.ballTransform.position.x<this.quarterFieldX?this.transform.position.y>this.midFieldY+5?this.yVelocity=1:this.transform.position.y<this.midFieldY-5?this.yVelocity=-1:this.yVelocity=0:(this.timer+=o.DeltaTime,this.timer>.15&&(this.transform.center.y<this.ballTransform.center.y-10?this.yVelocity=-1:this.transform.center.y>this.ballTransform.center.y+10?this.yVelocity=1:this.yVelocity=0,this.timer=0)),this.transform.translate(new i(this.xVelocity,this.yVelocity).multiplyScalar(this.speed))}}var G=s(2),L=s.n(G),S=s(3),E=s.n(S);let V=r.Instance,F=document.getElementById("game-canvas"),D=new class{constructor(t,e){this.image=new Image(t.width,t.height),this.image.src=e,this.canvasContext=t.getContext("2d"),this.gameCanvas=t}render(){this.canvasContext.drawImage(this.image,0,0,this.gameCanvas.width,this.gameCanvas.height)}}(F,L.a),k=new class extends d{constructor(t){super(t,0,0,0,0);let e=[],s=f.createInstance(this);e.push(s),e.push(new x(this)),this.setComponents(e)}}("GameManager"),A=new class extends d{constructor(t){super(t,2,175,10,50);let e=[];e.push(new l(this)),e.push(new T(this)),e.push(new v(this));let s=new M(b.a,4,1,.1);e.push(new j(this,s)),this.setComponents(e)}}("player"),P=new y("ball"),B=[k,A,new class extends d{constructor(t){super(t,688,175,10,50);let e=[];e.push(new l(this)),e.push(new R(this)),e.push(new g(this,"white")),this.setComponents(e)}}("computer"),P,new class extends d{constructor(t){super(t,400,280,75,75);let e=[];e.push(new l(this));let s=new M(E.a,10,4,.1,[4]);e.push(new j(this,s)),this.setComponents(e)}}("trump")];V.initializeGame(F,B,D),V.startGame()}]);
//# sourceMappingURL=bundle.js.map